# ============================================
# CIRCLE API CONFIGURATION - BUSINESS PLAN REQUIRED
# ============================================

# CRITICAL: Must be "Headless Auth" token from Circle Developers
# Get from: Circle Admin → Developers → Tokens → Create Token
# Select type: "Headless Auth" (NOT "API Token")
# Requires: Circle Business Plan or higher
CIRCLE_API_TOKEN=your_headless_auth_token_here

# CRITICAL: Circle Admin API token for managing tags (purchase tags, etc.)
# Get from: Circle Admin → Developers → Tokens → Create Token
# Select type: "Admin API" (different from Headless Auth)
# This is used to automatically remove numeric purchase tags after processing
# Requires: Circle Business Plan or higher
CIRCLE_ADMIN_API_TOKEN=your_admin_api_token_here

# Your Circle community domain (without protocol)
# Example: your-community.circle.so
CIRCLE_COMMUNITY_DOMAIN=your-community.circle.so

# ============================================
# APPLICATION CONFIGURATION
# ============================================

# Your application's public domain (where this app is hosted)
# Example: app.yourdomain.com or your-app.herokuapp.com
APP_DOMAIN=your-app.example.com

# Allowed origins for CORS (comma-separated)
# Must include both your Circle domain and app domain
# Example: https://your-community.circle.so,https://your-app.example.com
ALLOWED_ORIGINS=https://your-community.circle.so,https://your-app.example.com

# Application port (default 8080)
PORT=8080

# ============================================
# MEMBER & CREDIT CONFIGURATION
# ============================================

# Tags that identify paid/premium members (comma-separated)
# Members with these tags receive higher credit allocations
# Example: paid,premium,subscriber,member,vip,pro,business
PAID_MEMBER_TAGS=paid,premium,subscriber,member,vip,pro,business

# Initial credits granted to new members
# Free members get this amount on first login
INITIAL_CREDITS_FREE=10

# Paid members (those with tags above) get this amount on first login
INITIAL_CREDITS_PAID=100

# Monthly credit refresh amounts (added every 30 days)
# Free members receive this amount monthly
MONTHLY_CREDITS_FREE=10

# Paid members receive this amount monthly
MONTHLY_CREDITS_PAID=100

# ============================================
# PURCHASE TAG PROCESSING (ADMIN API REQUIRED)
# ============================================
# The app automatically detects and processes numeric tags like:
# - "$10", "$50", "$100" (with dollar sign)
# - "10", "50", "100" (without dollar sign)
# 
# When detected:
# 1. Credits are added to the member's balance
# 2. The tag is automatically removed from Circle (requires CIRCLE_ADMIN_API_TOKEN)
# 3. Transaction is logged in the database
#
# This allows for one-time credit purchases through Circle's payment system

# ============================================
# DATABASE CONFIGURATION
# ============================================

# PostgreSQL database settings
POSTGRES_DB=circle_app
POSTGRES_USER=circle_user
POSTGRES_PASSWORD=your_super_secure_password_here

# Complete database connection URL
# Format: postgres://username:password@host:port/database
# For Docker Compose, use 'db' as host: postgres://circle_user:password@db:5432/circle_app
# For external DB, use actual host: postgres://circle_user:password@your-db-host.com:5432/circle_app
DATABASE_URL=postgres://circle_user:your_super_secure_password_here@db:5432/circle_app

# ============================================
# SECURITY CONFIGURATION
# ============================================

# Enforce iframe embedding (set to true in production)
# When true, app can only be accessed from within Circle iframe
REQUIRE_IFRAME=true

# Disable insecure email-only authentication (set to true in production)
# When true, requires proper Circle authentication, not just email
DISABLE_EMAIL_ONLY_AUTH=true

# ============================================
# ENVIRONMENT MODE
# ============================================

# Environment mode: development, staging, or production
NODE_ENV=production

# ============================================
# OPTIONAL CONFIGURATION
# ============================================

# Debug mode (set to true for verbose logging)
DEBUG=false

# Log level: error, warn, info, verbose, debug
LOG_LEVEL=info

# Session secret (auto-generated if not provided)
# Used for signing session cookies
# SESSION_SECRET=your_random_session_secret_here

# Rate limiting (requests per minute per IP)
# RATE_LIMIT=100

# Maximum file upload size (in MB)
# MAX_UPLOAD_SIZE=10

# ============================================
# MONITORING & ANALYTICS (OPTIONAL)
# ============================================

# Sentry DSN for error tracking
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# Google Analytics ID
# GA_TRACKING_ID=UA-XXXXXXXXX-X

# ============================================
# NOTES
# ============================================
# 
# 1. Both API tokens (Headless Auth & Admin API) require Circle Business Plan or higher
# 2. Never commit this file with real values to version control
# 3. Copy this file to .env and fill in your actual values
# 4. Ensure all URLs use HTTPS in production
# 5. Keep your database password secure and complex
# 6. Rotate API tokens regularly for security
# 7. The Admin API token is optional but required for automatic purchase tag removal
# 8. Purchase tags are processed immediately when detected (no time limit)
# 9. All credit transactions are logged for audit purposes
# 10. Use Docker Compose for easier deployment and management